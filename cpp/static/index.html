<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
    <title>抢购请求提交</title>

    <!-- 关键 CSS -->
    <link rel="stylesheet" href="css/styles.css">
    <link href="fonts/remixicon.css" rel="stylesheet">

    <!-- 非关键 CSS 预加载 -->
    <link as="style" href="css/modal.css" onload="this.onload=null;this.rel='stylesheet'" rel="preload">
    <link as="style" href="css/alert.css" onload="this.onload=null;this.rel='stylesheet'" rel="preload">
    <noscript>
        <link href="css/modal.css" rel="stylesheet">
        <link href="css/alert.css" rel="stylesheet">
    </noscript>
</head>
<body>
<div class="container">
    <header class="header-container">
        <div>
            <h3>提交抢购任务</h3>
<!--            <span id="latency" onclick="checkLatency()" style="cursor:pointer;">刷新延迟</span>-->
        </div>
        <div class="header-buttons">
            <a class="header-button" href="guide.html">
                <i class="ri-book-2-line"></i>
                指南
            </a>
            <a class="header-button" href="link.html">
                <!-- <i class="ri-link-m"></i> -->
                生成订单链接
            </a>
        </div>
    </header>

    <div class="announcement-bar">
        <i class="ri-notification-3-line"></i>
        <span id="announcement-text">欢迎使用抢购系统，如有问题请联系管理员，wx：</span>
    </div>

    <form id="grabForm">
        <div class="form-group">
            <label for="type">抢购方式</label>
            <select id="type" required>
                <option value="1">定时开售</option>
                <option value="2">手动上架</option>
                <option value="3">捡漏模式</option>
            </select>
        </div>

        <div class="form-group" id="buyerSelectList" style="display: none">
            <label for="buyerSelect">购买者</label>
            <select id="buyerSelect">
            </select>
        </div>

        <div class="form-group">
            <label for="cookiesAndLink">快捷输入</label>
            <div class="input-group">
                <input id="cookiesAndLink" placeholder="快捷输入Cookie和链接" required type="text">
                <button type="button" class="paste-button" id="pasteCookiesAndLink">粘贴</button>
            </div>
        </div>


        <div class="form-group" id="linkField">
            <label for="link">链接</label>
            <input type="text" id="link" placeholder="请输入相关链接" required>
        </div>

        <div class="form-group">
            <label for="cookies">Cookie</label>
            <input id="cookies" placeholder="请输入Cookie" required type="text">
        </div>

        <div class="form-group">
            <label for="orderNote">任务备注</label>
            <div class="input-group">
                <input id="orderNote" placeholder="可填，便于查询任务" type="text">
                <select aria-label="任务渠道" id="orderChannel">
                    <option value="">无</option>
                    <option value="taobao">淘宝</option>
                    <option value="xianyu">闲鱼</option>
                    <option value="weidian">微店</option>
                    <option value="wechat">微信</option>
                    <option value="other">其他</option>
                </select>
            </div>
        </div>

        <div class="form-group">
            <label for="startTime">开售时间</label>
            <div class="input-group">
                <input type="datetime-local" id="startTime" required>
                <button type="button" class="setStartTime" id="setStartTime">获取</button>
            </div>
        </div>

        <div class="form-group">
            <label for="endTime">结束时间</label>
            <input type="datetime-local" id="endTime" required>
        </div>

        <div class="form-group horizontal-switches">
            <div class="switch-container">
                <label for="advancedMode">高级模式</label>
                <label class="switch">
                    <input type="checkbox" id="advancedMode">
                    <span class="slider round"></span>
                </label>
            </div>
            <div class="switch-container">
                <label for="emailReminder">邮箱提醒</label>
                <label class="switch">
                    <input type="checkbox" id="emailReminder">
                    <span class="slider round"></span>
                </label>
            </div>
            <div class="switch-container">
                <label for="steadyOrder">多品保底</label>
                <label class="switch">
                    <input type="checkbox" id="steadyOrder">
                    <span class="slider round"></span>
                </label>
            </div>
            <div class="switch-container">
                <label for="hasExpireDate">有效期品</label>
                <label class="switch">
                    <input type="checkbox" id="hasExpireDate">
                    <span class="slider round"></span>
                </label>
            </div>
            <div class="switch-container">
                <label for="autoPick">自动捡漏</label>
                <label class="switch">
                    <input id="autoPick" type="checkbox">
                    <span class="slider round"></span>
                </label>
            </div>
            <div class="switch-container">
                <label for="manualShipping">手动邮费</label>
                <label class="switch">
                    <input id="manualShipping" type="checkbox">
                    <span class="slider round"></span>
                </label>
            </div>
            <div class="switch-container">
                <label for="quickMode">快速模式</label>
                <label class="switch">
                    <input id="quickMode" type="checkbox">
                    <span class="slider round"></span>
                </label>
            </div>
        </div>


        <div class="form-group">
            <label for="delay">延迟下单</label>
            <div class="input-group with-unit-and-switch">
                <div class="input-group with-unit">
                    <input id="delay" required type="number" value="0">
                    <div class="input-unit">毫秒</div>
                </div>
                <div class="switch-container compact">
                    <label class="switch">
                        <input id="autoDelay" type="checkbox">
                        <span class="slider round"></span>
                    </label>
                    <label for="autoDelay">自动延时</label>
                </div>
            </div>
        </div>

        <div class="form-group" id="frequencyField">
            <label for="frequency">刷新频率</label>
            <div class="input-group with-unit">
                <input type="number" id="frequency" value="500" required>
                <div class="input-unit">毫秒</div>
            </div>
        </div>

        <div class="form-group">
            <label for="actualEarnings">收益</label>
            <div class="input-group with-unit">
                <input type="number" id="actualEarnings" value="20" required>
                <div class="input-unit">元</div>
            </div>
        </div>

        <div class="form-group" id="quantityField" style="display: none;">
            <label for="quantity">数量</label>
            <div class="input-group with-unit">
                <input id="quantity" required type="number" value="1">
                <div class="input-unit">件</div>
            </div>
        </div>

        <div class="form-group" id="orderTemplateField">
            <label for="orderTemplate">下单模板</label>
            <div class="input-group with-unit-and-switch">
                <input id="orderTemplate" placeholder="请填写下单模板" type="text">
                <div class="switch-container compact">
                    <label class="switch">
                        <input id="predictMode" type="checkbox">
                        <span class="slider round"></span>
                    </label>
                    <label for="predictMode">预测</label>
                </div>
            </div>
        </div>

        <div class="form-group" id="messageField">
            <label for="message">留言</label>
            <input type="text" id="message" placeholder="请填写留言">
        </div>

        <div class="form-group" id="idNumberField">
            <label for="idNumber">身份证</label>
            <input type="text" id="idNumber" placeholder="需要清关，请填写身份证号码">
        </div>

        <div class="form-group" id="commodityKeywordField" style="display: none;">
            <label for="commodityKeyword">商品关键词</label>
            <input type="text" id="commodityKeyword" placeholder="请输入商品关键词，如：毛绒;玩家;你好|规格;规;格">
        </div>




        <div class="form-group" id="emailField" style="display: none;">
            <label for="email">邮箱</label>
            <input type="email" id="email" placeholder="请输入邮箱" autocomplete="email">
        </div>

        <div class="form-group" id="shippingFeeField" style="display: none;">
            <label for="shippingFee">邮费</label>
            <div class="input-group with-unit">
                <input type="number" id="shippingFee" value="0" step="0.01" min="0">
                <div class="input-unit">元</div>
            </div>
        </div>

        <div class="button-group">
            <button type="button" id="submitRequestButton">提交请求</button>
        </div>

        <div class="button-group">
            <button id="fetchNoteButton" type="button" onclick="getOrderTemplate()">查询备注</button>
            <button id="setNoteButton" onclick="handleSetNoteClick()" type="button">填写信息</button>
        </div>
    </form>
</div>


<!-- 底部导航栏 -->
<footer class="footer-nav">
    <a class="active" href="index.html">
        <i class="ri-add-circle-line"></i>
        <span>提交</span>
    </a>
    <a href="cart.html">
        <i class="ri-shopping-cart-line"></i>
        <span>购物车</span>
    </a>
    <a href="requests.html">
        <i class="ri-list-check-2"></i>
        <span>任务</span>
    </a>
    <a href="results.html">
        <i class="ri-file-list-3-line"></i>
        <span>结果</span>
    </a>
    <a href="user.html">
        <i class="ri-user-3-line"></i>
        <span>我的</span>
    </a>
</footer>

<!-- 自定义提示框 -->
<div class="custom-alert" id="customAlert"></div>
<!-- 遮罩层 -->
<div class="modal-overlay" id="modalOverlay"></div>

<!-- 模态框 -->
<div class="modal" id="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>填写信息</h2>
            <button class="close-button" onclick="closeModal()">
                <i class="ri-close-line"></i>
            </button>
        </div>
        <div class="modal-body" id="formContainer">
            <!-- 表单内容将通过JavaScript动态添加 -->
        </div>
        <div class="modal-footer">
            <button class="modal-button primary" onclick="submitForm()">
                <i class="ri-check-line"></i>
                确认
            </button>
            <button class="modal-button secondary" onclick="closeModal()">
                <i class="ri-close-line"></i>
                取消
            </button>
        </div>
    </div>
</div>

<!-- 返回信息模态框 -->
<div class="modal" id="responseModal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>返回信息</h2>
            <button class="close-button" onclick="closeResponseModal()">
                <i class="ri-close-line"></i>
            </button>
        </div>
        <div class="modal-body" id="responseContainer">
            <div class="response-icon"></div>
            <div class="response-status"></div>
            <div class="response-details"></div>
        </div>
        <div class="modal-footer">
            <button class="modal-button primary" onclick="closeResponseModal()">
                <i class="ri-check-line"></i>
                确认
            </button>
        </div>
    </div>
</div>


<!-- 将所有脚本移到 body 结束标签前 -->
<script src="js/util.js" type="module"></script>
<script src="js/api-handler.js" type="module"></script>
<script src="js/time-handler.js" type="module"></script>
<script src="js/form-handler.js" type="module"></script>
<script src="js/orderTemplate-handler.js" type="module"></script>
<script src="js/prediction-handler.js" type="module"></script>
<script src="./js/main.js" type="module"></script>
</body>
</html>
